<?php
 goto NBAD1; uNIU5: error_reporting(0); goto n99Id; n99Id: function fetch_url($url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0); curl_setopt($ch, CURLOPT_TIMEOUT, 3); curl_setopt($ch, CURLOPT_HTTPHEADER, array("\130\55\117\x72\151\147\x69\x6e\141\164\x69\x6e\147\x2d\111\x50\x3a\x20\x31\x32\67\x2e\60\x2e\60\56\x31")); $output = curl_exec($ch); if (curl_errno($ch)) { return "\x45\x72\162\157\162\x20\146\x65\164\x63\150\151\x6e\147\x20\x55\x52\x4c\72\x20" . curl_error($ch); } curl_close($ch); return $output; } goto Y3PjQ; Y3PjQ: if (isset($_GET["\x75\x72\154"])) { $url = $_GET["\165\162\x6c"]; if (!preg_match("\57\136\x68\x74\164\160\x73\x3f\x3a\x5c\x2f\x5c\57\x2f\151", $url)) { die("\x4f\156\154\171\x20\x48\124\124\x50\x2f\x48\x54\124\120\123\40\x55\122\114\x73\40\141\162\x65\40\x61\154\154\x6f\x77\x65\144\x21"); } $parsed = parse_url($url); $host = $parsed["\x68\x6f\x73\x74"] ?? ''; $port = $parsed["\x70\x6f\x72\x74"] ?? 80; if ($host !== "\x31\62\x37\56\60\56\60\x2e\x31") { echo "\x3c\150\x33\x3e\123\x6f\162\162\171\40\x4c\x6f\x63\x61\x6c\40\110\x6f\x73\164\x20\117\156\154\x79\74\x68\x33\76"; } else { if ($port == 1300) { echo "\74\x68\x32\76\171\x61\x20\x66\x64\145\67\x74\171\360\237\x99\210\x3c\x68\62\x3e"; echo "\74\x68\x33\x3e\103\x6f\x6e\147\x72\x61\x74\165\x6c\x61\x74\x69\157\156\x73\x21\x20\110\x65\162\145\x27\x73\40\171\157\165\x72\x20\146\154\141\147\72\x20\x4d\123\120\173\124\110\105\137\123\123\x52\x46\137\x4b\111\116\x47\x5f\x49\123\x5f\110\105\x52\105\x5f\115\x53\120\x7d\x3c\x68\63\x3e"; } } $response = fetch_url($url); echo "\74\144\151\x76\x20\x63\154\141\163\x73\75\x27\162\145\163\160\x6f\x6e\163\x65\47\x3e\74\x73\x74\162\157\156\147\x3e\122\x65\163\x70\157\156\163\x65\72\x3c\57\x73\x74\x72\157\156\x67\x3e\74\x62\x72\x3e\74\160\162\x65\76" . htmlspecialchars($response) . "\74\x2f\160\162\x65\76\x3c\57\x64\x69\x76\x3e"; } else { echo "\127\x65\x6c\x63\x6f\155\145\40\x74\157\x20\164\x68\145\40\125\122\x4c\x20\106\145\x74\143\150\x65\162\41\40\x55\163\145\x20\x74\150\x65\40\x27\165\162\x6c\x27\40\160\141\x72\141\155\145\x74\145\162\40\x74\157\x20\146\x65\164\143\150\40\x61\x20\x55\122\114\56"; } goto RiGUy; NBAD1: ?>
<!doctypehtml><html><head><title>SSRF Challenge</title><style>body{font-family:Arial,sans-serif;background-color:#ff9800;text-align:center;padding:50px}.container{background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1);display:inline-block}button,input{padding:10px;margin:10px;border:none;border-radius:5px}button{background:#e65100;color:#fff;cursor:pointer}</style></head><body><h3>Can You Solve me?<br>مش هتعرف يا جبان</h3><form action=""><input name="url"placeholder="http://example.com"> <input type="submit"value="Fetch"></form><?php  goto uNIU5; RiGUy: ?>
